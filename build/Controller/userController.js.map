{"version":3,"file":"userController.js","names":["getLogin","req","res","render","title","postLogin","dbConfig","getDbConfig","body","userDbConnect","dbkind","console","log","message","status","errorMessage","session","loggedIn","loginInfo","dbUser","user","dbName","database","dbHostIp","server","host","dbPort","port","dbKind","dbPassword","dbpassword","redirect","getLogout","destroy"],"sources":["../../src/Controller/userController.js"],"sourcesContent":["import { getDbConfig } from \"../dbs/getDbConfig\";\nimport userDbConnect from \"../dbs/userDbConnect\";\n\n//GET /login\nexport const getLogin = (req, res) => {\n\treturn res.render('login', { title : 'login'})\n}\n\n//POST /login\n//db connection 필요하므로, async로 정의\nexport const postLogin = async (req, res) => {\n\t//dbconnection 만들기 여기서 해야함.\n\n\t//config파일 만들어오기\n\tconst dbConfig = getDbConfig(req.body);\n\n\ttry {\n\t\tawait userDbConnect(req.body.dbkind, dbConfig);\n\t} catch (e) {\n\t\tconsole.log(e.message);\n\t\treturn (res.status(400).render('login', { \n\t\t\ttitle : 'login', \n\t\t\terrorMessage : e.message}))\n\t}\n\n\tconsole.log('로그인성공!')\n\t//브라우저측에 세션정보 저장하기\n\treq.session.loggedIn = true;\n\treq.session.loginInfo = {\n\t\tdbUser : dbConfig.user,\n\t\tdbName : dbConfig.database,\n\t\tdbHostIp : dbConfig.server || dbConfig.host,\n\t\tdbPort : dbConfig.port,\n\t\tdbKind : req.body.dbkind,\n\t\tdbPassword : req.body.dbpassword //나중에 암호화해서 저장..\n\t}\n\t//local middleware에서 local에 저장하게됨\n\tres.redirect('/');\n}\n\nexport const getLogout = (req, res) => {\n\treq.session.destroy();\n\treturn res.redirect(\"/\");\n}\n"],"mappings":";;;;;;;AAAA;AACA;AAAiD;AAAA,+CAAjD;AAAA;AAAA;AAEA;AACO,IAAMA,QAAQ,GAAG,SAAXA,QAAQ,CAAIC,GAAG,EAAEC,GAAG,EAAK;EACrC,OAAOA,GAAG,CAACC,MAAM,CAAC,OAAO,EAAE;IAAEC,KAAK,EAAG;EAAO,CAAC,CAAC;AAC/C,CAAC;;AAED;AACA;AAAA;AACO,IAAMC,SAAS;EAAA,sEAAG,iBAAOJ,GAAG,EAAEC,GAAG;IAAA;IAAA;MAAA;QAAA;UAAA;YACvC;YAEA;YACMI,QAAQ,GAAG,IAAAC,wBAAW,EAACN,GAAG,CAACO,IAAI,CAAC;YAAA;YAAA;YAAA,OAG/B,IAAAC,yBAAa,EAACR,GAAG,CAACO,IAAI,CAACE,MAAM,EAAEJ,QAAQ,CAAC;UAAA;YAAA;YAAA;UAAA;YAAA;YAAA;YAE9CK,OAAO,CAACC,GAAG,CAAC,YAAEC,OAAO,CAAC;YAAC,iCACfX,GAAG,CAACY,MAAM,CAAC,GAAG,CAAC,CAACX,MAAM,CAAC,OAAO,EAAE;cACvCC,KAAK,EAAG,OAAO;cACfW,YAAY,EAAG,YAAEF;YAAO,CAAC,CAAC;UAAA;YAG5BF,OAAO,CAACC,GAAG,CAAC,QAAQ,CAAC;YACrB;YACAX,GAAG,CAACe,OAAO,CAACC,QAAQ,GAAG,IAAI;YAC3BhB,GAAG,CAACe,OAAO,CAACE,SAAS,GAAG;cACvBC,MAAM,EAAGb,QAAQ,CAACc,IAAI;cACtBC,MAAM,EAAGf,QAAQ,CAACgB,QAAQ;cAC1BC,QAAQ,EAAGjB,QAAQ,CAACkB,MAAM,IAAIlB,QAAQ,CAACmB,IAAI;cAC3CC,MAAM,EAAGpB,QAAQ,CAACqB,IAAI;cACtBC,MAAM,EAAG3B,GAAG,CAACO,IAAI,CAACE,MAAM;cACxBmB,UAAU,EAAG5B,GAAG,CAACO,IAAI,CAACsB,UAAU,CAAC;YAClC,CAAC;YACD;YACA5B,GAAG,CAAC6B,QAAQ,CAAC,GAAG,CAAC;UAAC;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA,CAClB;EAAA,gBA5BY1B,SAAS;IAAA;EAAA;AAAA,GA4BrB;AAAA;AAEM,IAAM2B,SAAS,GAAG,SAAZA,SAAS,CAAI/B,GAAG,EAAEC,GAAG,EAAK;EACtCD,GAAG,CAACe,OAAO,CAACiB,OAAO,EAAE;EACrB,OAAO/B,GAAG,CAAC6B,QAAQ,CAAC,GAAG,CAAC;AACzB,CAAC;AAAA"}